# Aliases for pentesting
alias pubip="host myip.opendns.com resolver1.opendns.com | grep -oE '\b([0-9]{1,3}\.){3}[0-9]{1,3}\b' | awk 'NR==2'"
alias vpnip="ip -4 addr show tun0 | grep -oP \"(?<=inet\s)\d+(\.\d+){3}\""
alias connecthtb="sudo openvpn $HOME/vpns/htb-vip.ovpn"
#TODO:
# Add feature that allows you to pass vpn name as function param
# and then connects to that using sudo privs.

# function convpn() {
#
# }

function addhost() {
  if [[ $EUID -ne 0 ]]; then
    echo "This script must be run as root" >&2
    return 1
  fi

  local input="$1"
  if [[ -z "$input" ]]; then
    echo "Usage: host <IP Address> [hostname1] [hostname2] [hostname3] ..."
    return 1
  fi

  local ip_address=""
  if [[ "$input" =~ ^[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+$ ]]; then
    ip_address="$input"
    read -r -p "Enter hostname: " hostname
  else
    hostname="$input"
    read -r -p "Enter IP address: " ip_address
  fi

  echo "$ip_address $hostname" | sudo tee -a /etc/hosts
  echo "Added $hostname ($ip_address) to /etc/hosts"
}

# create a new directory and navigate to it.
# usage - mcd test
mcd() {
    mkdir -p -- "$1" && cd -P -- "$1";
}

# start a python server on a port and a dir.
# usage - serve 8080 /opt
serve() {
    PORT=$1
    DIR=$2
    echo "Serving files from $DIR"
    python3 -m http.server "$PORT" --directory "$DIR"
}

# NetCat reveerse shell with rlwarp
# usage - rev 8080
rev() {
    PORT=$1
    echo "Starting Netcat Listener on $PORT"
    echo "# python -c 'import pty;pty.spawn(\"/bin/bash\")'"
    echo "# python3 -c 'import pty;pty.spawn(\"/bin/bash\")'"
    echo "# EXPORT TERM=xterm-256color"
    rlwrap -cAr nc -lvnp $PORT
}

# TODO
# add more features.
get() {
    file=$1
    echo "Location of the file copied to clipboard"
    realpath "$file" | xclip -select clipboard
}

# search within NSE
# usage - nse http
nse() {
  nsedb=$"acarsd-info.nse\naddress-info.nse\nafp-brute.nse\nafp-ls.nse\nafp-path-vuln.nse\nafp-serverinfo.nse\nafp-showmount.nse\najp-auth.nse\najp-brute.nse\najp-headers.nse\najp-methods.nse\najp-request.nse\nallseeingeye-info.nse\namqp-info.nse\nasn-query.nse\nauth-owners.nse\nauth-spoof.nse\nbackorifice-brute.nse\nbackorifice-info.nse\nbacnet-info.nse\nbanner.nse\nbitcoin-getaddr.nse\nbitcoin-info.nse\nbitcoinrpc-info.nse\nbittorrent-discovery.nse\nbjnp-discover.nse\nbroadcast-ataoe-discover.nse\nbroadcast-avahi-dos.nse\nbroadcast-bjnp-discover.nse\nbroadcast-db2-discover.nse\nbroadcast-dhcp-discover.nse\nbroadcast-dhcp6-discover.nse\nbroadcast-dns-service-discovery.nse\nbroadcast-dropbox-listener.nse\nbroadcast-eigrp-discovery.nse\nbroadcast-hid-discoveryd.nse\nbroadcast-igmp-discovery.nse\nbroadcast-jenkins-discover.nse\nbroadcast-listener.nse\nbroadcast-ms-sql-discover.nse\nbroadcast-netbios-master-browser.nse\nbroadcast-networker-discover.nse\nbroadcast-novell-locate.nse\nbroadcast-ospf2-discover.nse\nbroadcast-pc-anywhere.nse\nbroadcast-pc-duo.nse\nbroadcast-pim-discovery.nse\nbroadcast-ping.nse\nbroadcast-pppoe-discover.nse\nbroadcast-rip-discover.nse\nbroadcast-ripng-discover.nse\nbroadcast-sonicwall-discover.nse\nbroadcast-sybase-asa-discover.nse\nbroadcast-tellstick-discover.nse\nbroadcast-upnp-info.nse\nbroadcast-versant-locate.nse\nbroadcast-wake-on-lan.nse\nbroadcast-wpad-discover.nse\nbroadcast-wsdd-discover.nse\nbroadcast-xdmcp-discover.nse\ncassandra-brute.nse\ncassandra-info.nse\ncccam-version.nse\ncics-enum.nse\ncics-info.nse\ncics-user-brute.nse\ncics-user-enum.nse\ncitrix-brute-xml.nse\ncitrix-enum-apps-xml.nse\ncitrix-enum-apps.nse\ncitrix-enum-servers-xml.nse\ncitrix-enum-servers.nse\nclamav-exec.nse\nclock-skew.nse\ncoap-resources.nse\ncouchdb-databases.nse\ncouchdb-stats.nse\ncreds-summary.nse\ncups-info.nse\ncups-queue-info.nse\ncvs-brute-repository.nse\ncvs-brute.nse\ndaap-get-library.nse\ndaytime.nse\ndb2-das-info.nse\ndeluge-rpc-brute.nse\ndhcp-discover.nse\ndicom-brute.nse\ndicom-ping.nse\ndict-info.nse\ndistcc-cve2004-2687.nse\ndns-blacklist.nse\ndns-brute.nse\ndns-cache-snoop.nse\ndns-check-zone.nse\ndns-client-subnet-scan.nse\ndns-fuzz.nse\ndns-ip6-arpa-scan.nse\ndns-nsec-enum.nse\ndns-nsec3-enum.nse\ndns-nsid.nse\ndns-random-srcport.nse\ndns-random-txid.nse\ndns-recursion.nse\ndns-service-discovery.nse\ndns-srv-enum.nse\ndns-update.nse\ndns-zeustracker.nse\ndns-zone-transfer.nse\ndocker-version.nse\ndomcon-brute.nse\ndomcon-cmd.nse\ndomino-enum-users.nse\ndpap-brute.nse\ndrda-brute.nse\ndrda-info.nse\nduplicates.nse\neap-info.nse\nenip-info.nse\nepmd-info.nse\neppc-enum-processes.nse\nfcrdns.nse\nfinger.nse\nfingerprint-strings.nse\nfirewalk.nse\nfirewall-bypass.nse\nflume-master-info.nse\nfox-info.nse\nfreelancer-info.nse\nftp-anon.nse\nftp-bounce.nse\nftp-brute.nse\nftp-libopie.nse\nftp-proftpd-backdoor.nse\nftp-syst.nse\nftp-vsftpd-backdoor.nse\nftp-vuln-cve2010-4221.nse\nganglia-info.nse\ngiop-info.nse\ngkrellm-info.nse\ngopher-ls.nse\ngpsd-info.nse\nhadoop-datanode-info.nse\nhadoop-jobtracker-info.nse\nhadoop-namenode-info.nse\nhadoop-secondary-namenode-info.nse\nhadoop-tasktracker-info.nse\nhbase-master-info.nse\nhbase-region-info.nse\nhddtemp-info.nse\nhnap-info.nse\nhostmap-bfk.nse\nhostmap-crtsh.nse\nhostmap-robtex.nse\nhttp-adobe-coldfusion-apsa1301.nse\nhttp-affiliate-id.nse\nhttp-apache-negotiation.nse\nhttp-apache-server-status.nse\nhttp-aspnet-debug.nse\nhttp-auth-finder.nse\nhttp-auth.nse\nhttp-avaya-ipoffice-users.nse\nhttp-awstatstotals-exec.nse\nhttp-axis2-dir-traversal.nse\nhttp-backup-finder.nse\nhttp-barracuda-dir-traversal.nse\nhttp-bigip-cookie.nse\nhttp-brute.nse\nhttp-cakephp-version.nse\nhttp-chrono.nse\nhttp-cisco-anyconnect.nse\nhttp-coldfusion-subzero.nse\nhttp-comments-displayer.nse\nhttp-config-backup.nse\nhttp-cookie-flags.nse\nhttp-cors.nse\nhttp-cross-domain-policy.nse\nhttp-csrf.nse\nhttp-date.nse\nhttp-default-accounts.nse\nhttp-devframework.nse\nhttp-dlink-backdoor.nse\nhttp-dombased-xss.nse\nhttp-domino-enum-passwords.nse\nhttp-drupal-enum-users.nse\nhttp-drupal-enum.nse\nhttp-enum.nse\nhttp-errors.nse\nhttp-exif-spider.nse\nhttp-favicon.nse\nhttp-feed.nse\nhttp-fetch.nse\nhttp-fileupload-exploiter.nse\nhttp-form-brute.nse\nhttp-form-fuzzer.nse\nhttp-frontpage-login.nse\nhttp-generator.nse\nhttp-git.nse\nhttp-gitweb-projects-enum.nse\nhttp-google-malware.nse\nhttp-grep.nse\nhttp-headers.nse\nhttp-hp-ilo-info.nse\nhttp-huawei-hg5xx-vuln.nse\nhttp-icloud-findmyiphone.nse\nhttp-icloud-sendmsg.nse\nhttp-iis-short-name-brute.nse\nhttp-iis-webdav-vuln.nse\nhttp-internal-ip-disclosure.nse\nhttp-joomla-brute.nse\nhttp-jsonp-detection.nse\nhttp-litespeed-sourcecode-download.nse\nhttp-ls.nse\nhttp-majordomo2-dir-traversal.nse\nhttp-malware-host.nse\nhttp-mcmp.nse\nhttp-method-tamper.nse\nhttp-methods.nse\nhttp-mobileversion-checker.nse\nhttp-ntlm-info.nse\nhttp-open-proxy.nse\nhttp-open-redirect.nse\nhttp-passwd.nse\nhttp-php-version.nse\nhttp-phpmyadmin-dir-traversal.nse\nhttp-phpself-xss.nse\nhttp-proxy-brute.nse\nhttp-put.nse\nhttp-qnap-nas-info.nse\nhttp-referer-checker.nse\nhttp-rfi-spider.nse\nhttp-robots.txt.nse\nhttp-robtex-reverse-ip.nse\nhttp-robtex-shared-ns.nse\nhttp-sap-netweaver-leak.nse\nhttp-security-headers.nse\nhttp-server-header.nse\nhttp-shellshock.nse\nhttp-sitemap-generator.nse\nhttp-slowloris-check.nse\nhttp-slowloris.nse\nhttp-sql-injection.nse\nhttp-stored-xss.nse\nhttp-svn-enum.nse\nhttp-svn-info.nse\nhttp-title.nse\nhttp-tplink-dir-traversal.nse\nhttp-trace.nse\nhttp-traceroute.nse\nhttp-trane-info.nse\nhttp-unsafe-output-escaping.nse\nhttp-useragent-tester.nse\nhttp-userdir-enum.nse\nhttp-vhosts.nse\nhttp-virustotal.nse\nhttp-vlcstreamer-ls.nse\nhttp-vmware-path-vuln.nse\nhttp-vuln-cve2006-3392.nse\nhttp-vuln-cve2009-3960.nse\nhttp-vuln-cve2010-0738.nse\nhttp-vuln-cve2010-2861.nse\nhttp-vuln-cve2011-3192.nse\nhttp-vuln-cve2011-3368.nse\nhttp-vuln-cve2012-1823.nse\nhttp-vuln-cve2013-0156.nse\nhttp-vuln-cve2013-6786.nse\nhttp-vuln-cve2013-7091.nse\nhttp-vuln-cve2014-2126.nse\nhttp-vuln-cve2014-2127.nse\nhttp-vuln-cve2014-2128.nse\nhttp-vuln-cve2014-2129.nse\nhttp-vuln-cve2014-3704.nse\nhttp-vuln-cve2014-8877.nse\nhttp-vuln-cve2015-1427.nse\nhttp-vuln-cve2015-1635.nse\nhttp-vuln-cve2017-1001000.nse\nhttp-vuln-cve2017-5638.nse\nhttp-vuln-cve2017-5689.nse\nhttp-vuln-cve2017-8917.nse\nhttp-vuln-misfortune-cookie.nse\nhttp-vuln-wnr1000-creds.nse\nhttp-waf-detect.nse\nhttp-waf-fingerprint.nse\nhttp-webdav-scan.nse\nhttp-wordpress-brute.nse\nhttp-wordpress-enum.nse\nhttp-wordpress-users.nse\nhttp-xssed.nse\nhttps-redirect.nse\niax2-brute.nse\niax2-version.nse\nicap-info.nse\niec-identify.nse\nike-version.nse\nimap-brute.nse\nimap-capabilities.nse\nimap-ntlm-info.nse\nimpress-remote-discover.nse\ninformix-brute.nse\ninformix-query.nse\ninformix-tables.nse\nip-forwarding.nse\nip-geolocation-geoplugin.nse\nip-geolocation-ipinfodb.nse\nip-geolocation-map-bing.nse\nip-geolocation-map-google.nse\nip-geolocation-map-kml.nse\nip-geolocation-maxmind.nse\nip-https-discover.nse\nipidseq.nse\nipmi-brute.nse\nipmi-cipher-zero.nse\nipmi-version.nse\nipv6-multicast-mld-list.nse\nipv6-node-info.nse\nipv6-ra-flood.nse\nirc-botnet-channels.nse\nirc-brute.nse\nirc-info.nse\nirc-sasl-brute.nse\nirc-unrealircd-backdoor.nse\niscsi-brute.nse\niscsi-info.nse\nisns-info.nse\njdwp-exec.nse\njdwp-info.nse\njdwp-inject.nse\njdwp-version.nse\nknx-gateway-discover.nse\nknx-gateway-info.nse\nkrb5-enum-users.nse\nldap-brute.nse\nldap-novell-getpass.nse\nldap-rootdse.nse\nldap-search.nse\nlexmark-config.nse\nllmnr-resolve.nse\nlltd-discovery.nse\nlu-enum.nse\nmaxdb-info.nse\nmcafee-epo-agent.nse\nmembase-brute.nse\nmembase-http-info.nse\nmemcached-info.nse\nmetasploit-info.nse\nmetasploit-msgrpc-brute.nse\nmetasploit-xmlrpc-brute.nse\nmikrotik-routeros-brute.nse\nmmouse-brute.nse\nmmouse-exec.nse\nmodbus-discover.nse\nmongodb-brute.nse\nmongodb-databases.nse\nmongodb-info.nse\nmqtt-subscribe.nse\nmrinfo.nse\nms-sql-brute.nse\nms-sql-config.nse\nms-sql-dac.nse\nms-sql-dump-hashes.nse\nms-sql-empty-password.nse\nms-sql-hasdbaccess.nse\nms-sql-info.nse\nms-sql-ntlm-info.nse\nms-sql-query.nse\nms-sql-tables.nse\nms-sql-xp-cmdshell.nse\nmsrpc-enum.nse\nmtrace.nse\nmurmur-version.nse\nmysql-audit.nse\nmysql-brute.nse\nmysql-databases.nse\nmysql-dump-hashes.nse\nmysql-empty-password.nse\nmysql-enum.nse\nmysql-info.nse\nmysql-query.nse\nmysql-users.nse\nmysql-variables.nse\nmysql-vuln-cve2012-2122.nse\nnat-pmp-info.nse\nnat-pmp-mapport.nse\nnbd-info.nse\nnbns-interfaces.nse\nnbstat.nse\nncp-enum-users.nse\nncp-serverinfo.nse\nndmp-fs-info.nse\nndmp-version.nse\nnessus-brute.nse\nnessus-xmlrpc-brute.nse\nnetbus-auth-bypass.nse\nnetbus-brute.nse\nnetbus-info.nse\nnetbus-version.nse\nnexpose-brute.nse\nnfs-ls.nse\nnfs-showmount.nse\nnfs-statfs.nse\nnje-node-brute.nse\nnje-pass-brute.nse\nnntp-ntlm-info.nse\nnping-brute.nse\nnrpe-enum.nse\nntp-info.nse\nntp-monlist.nse\nomp2-brute.nse\nomp2-enum-targets.nse\nomron-info.nse\nopenflow-info.nse\nopenlookup-info.nse\nopenvas-otp-brute.nse\nopenwebnet-discovery.nse\noracle-brute-stealth.nse\noracle-brute.nse\noracle-enum-users.nse\noracle-sid-brute.nse\noracle-tns-version.nse\novs-agent-version.nse\np2p-conficker.nse\npath-mtu.nse\npcanywhere-brute.nse\npcworx-info.nse\npgsql-brute.nse\npjl-ready-message.nse\npop3-brute.nse\npop3-capabilities.nse\npop3-ntlm-info.nse\nport-states.nse\npptp-version.nse\npuppet-naivesigning.nse\nqconn-exec.nse\nqscan.nse\nquake1-info.nse\nquake3-info.nse\nquake3-master-getservers.nse\nrdp-enum-encryption.nse\nrdp-ntlm-info.nse\nrdp-vuln-ms12-020.nse\nrealvnc-auth-bypass.nse\nredis-brute.nse\nredis-info.nse\nresolveall.nse\nreverse-index.nse\nrexec-brute.nse\nrfc868-time.nse\nriak-http-info.nse\nrlogin-brute.nse\nrmi-dumpregistry.nse\nrmi-vuln-classloader.nse\nrpc-grind.nse\nrpcap-brute.nse\nrpcap-info.nse\nrpcinfo.nse\nrsa-vuln-roca.nse\nrsync-brute.nse\nrsync-list-modules.nse\nrtsp-methods.nse\nrtsp-url-brute.nse\nrusers.nse\ns7-info.nse\nsamba-vuln-cve-2012-1182.nse\nscript.db\nservicetags.nse\nshodan-api.nse\nsip-brute.nse\nsip-call-spoof.nse\nsip-enum-users.nse\nsip-methods.nse\nskypev2-version.nse\nsmb-brute.nse\nsmb-double-pulsar-backdoor.nse\nsmb-enum-domains.nse\nsmb-enum-groups.nse\nsmb-enum-processes.nse\nsmb-enum-services.nse\nsmb-enum-sessions.nse\nsmb-enum-shares.nse\nsmb-enum-users.nse\nsmb-flood.nse\nsmb-ls.nse\nsmb-mbenum.nse\nsmb-os-discovery.nse\nsmb-print-text.nse\nsmb-protocols.nse\nsmb-psexec.nse\nsmb-security-mode.nse\nsmb-server-stats.nse\nsmb-system-info.nse\nsmb-vuln-conficker.nse\nsmb-vuln-cve-2017-7494.nse\nsmb-vuln-cve2009-3103.nse\nsmb-vuln-ms06-025.nse\nsmb-vuln-ms07-029.nse\nsmb-vuln-ms08-067.nse\nsmb-vuln-ms10-054.nse\nsmb-vuln-ms10-061.nse\nsmb-vuln-ms17-010.nse\nsmb-vuln-regsvc-dos.nse\nsmb-vuln-webexec.nse\nsmb-webexec-exploit.nse\nsmb2-capabilities.nse\nsmb2-security-mode.nse\nsmb2-time.nse\nsmb2-vuln-uptime.nse\nsmtp-brute.nse\nsmtp-commands.nse\nsmtp-enum-users.nse\nsmtp-ntlm-info.nse\nsmtp-open-relay.nse\nsmtp-strangeport.nse\nsmtp-vuln-cve2010-4344.nse\nsmtp-vuln-cve2011-1720.nse\nsmtp-vuln-cve2011-1764.nse\nsniffer-detect.nse\nsnmp-brute.nse\nsnmp-hh3c-logins.nse\nsnmp-info.nse\nsnmp-interfaces.nse\nsnmp-ios-config.nse\nsnmp-netstat.nse\nsnmp-processes.nse\nsnmp-sysdescr.nse\nsnmp-win32-services.nse\nsnmp-win32-shares.nse\nsnmp-win32-software.nse\nsnmp-win32-users.nse\nsocks-auth-info.nse\nsocks-brute.nse\nsocks-open-proxy.nse\nssh-auth-methods.nse\nssh-brute.nse\nssh-hostkey.nse\nssh-publickey-acceptance.nse\nssh-run.nse\nssh2-enum-algos.nse\nsshv1.nse\nssl-ccs-injection.nse\nssl-cert-intaddr.nse\nssl-cert.nse\nssl-date.nse\nssl-dh-params.nse\nssl-enum-ciphers.nse\nssl-heartbleed.nse\nssl-known-key.nse\nssl-poodle.nse\nsslv2-drown.nse\nsslv2.nse\nsstp-discover.nse\nstun-info.nse\nstun-version.nse\nstuxnet-detect.nse\nsupermicro-ipmi-conf.nse\nsvn-brute.nse\ntargets-asn.nse\ntargets-ipv6-map4to6.nse\ntargets-ipv6-multicast-echo.nse\ntargets-ipv6-multicast-invalid-dst.nse\ntargets-ipv6-multicast-mld.nse\ntargets-ipv6-multicast-slaac.nse\ntargets-ipv6-wordlist.nse\ntargets-sniffer.nse\ntargets-traceroute.nse\ntargets-xml.nse\nteamspeak2-version.nse\ntelnet-brute.nse\ntelnet-encryption.nse\ntelnet-ntlm-info.nse\ntftp-enum.nse\ntftp-version.nse\ntls-alpn.nse\ntls-nextprotoneg.nse\ntls-ticketbleed.nse\ntn3270-screen.nse\ntor-consensus-checker.nse\ntraceroute-geolocation.nse\ntso-brute.nse\ntso-enum.nse\nubiquiti-discovery.nse\nunittest.nse\nunusual-port.nse\nupnp-info.nse\nuptime-agent-info.nse\nurl-snarf.nse\nventrilo-info.nse\nversant-info.nse\nvmauthd-brute.nse\nvmware-version.nse\nvnc-brute.nse\nvnc-info.nse\nvnc-title.nse\nvoldemort-info.nse\nvtam-enum.nse\nvulners.nse\nvuze-dht-info.nse\nwdb-version.nse\nweblogic-t3-info.nse\nwhois-domain.nse\nwhois-ip.nse\nwsdd-discover.nse\nx11-access.nse\nxdmcp-discover.nse\nxmlrpc-methods.nse\nxmpp-brute.nse\nxmpp-info.nse\n"

  local search_string="$1"
  if [[ -z "$search_string" ]]; then
    echo "Usage: nse <search_string>"
    return 1
  fi

  echo "$nsedb" | grep -i "$search_string"
}
